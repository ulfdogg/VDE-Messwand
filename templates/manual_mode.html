{% extends "base.html" %}
{% block title %}Manuelle Fehler - VDE Messwand{% endblock %}

{% block content %}
<div class="glass-card">
    <h1>Manuelle Fehler Zuschaltung</h1>
    
    <div style="max-width: 900px; margin: 0 auto;">
        {% for stromkreis_num, stromkreis_info in stromkreise.items() %}
        <div class="form-group" style="margin-bottom: 25px;">
            <label for="stromkreis{{ stromkreis_num }}" style="font-weight: bold; color: #2196F3; margin-bottom: 8px; display: block;">
                Stromkreis {{ stromkreis_num }}: {{ stromkreis_info.name }} ({{ stromkreis_info.errors|length }} Fehler):
            </label>
            <select id="stromkreis{{ stromkreis_num }}" class="form-control" style="font-size: 14px; padding: 8px;">
                <option value="">Kein Fehler</option>
                {% for error in stromkreis_info.errors %}
                <option value="{{ error.relay_id }}" title="{{ error.description }}">
                    {{ error.name }} ({{ error.category }}, Relais {{ error.relay_id }})
                </option>
                {% endfor %}
            </select>
            <div id="description{{ stromkreis_num }}" class="error-description" style="margin-top: 8px; font-size: 12px; color: #666; font-style: italic; min-height: 20px; padding: 5px; background: rgba(255,255,255,0.05); border-radius: 4px;">
                <!-- Fehlerbeschreibung wird hier via JS angezeigt -->
            </div>
        </div>
        {% endfor %}
        
        <div class="btn-group" style="margin-top: 30px; text-align: center;">
            <button class="btn" onclick="setManualErrors()" style="background: linear-gradient(45deg, #2196F3, #21CBF3); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-right: 10px; font-weight: bold;">
                âš¡ Fehler Zuschalten
            </button>
            <button class="btn btn-secondary" onclick="resetRelays()" style="background: linear-gradient(45deg, #f44336, #ff6b6b); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                ðŸ”„ Alle ZurÃ¼cksetzen
            </button>
        </div>
        
        <div id="status-display" style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.08); border-radius: 8px; border-left: 4px solid #2196F3;">
            <strong>Status:</strong> <span id="status-text">Keine Fehler aktiv</span>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='script.js') }}"></script>

<style>
.error-description {
    transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.1);
}
.form-control {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    color: white;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
.form-control:focus {
    outline: none;
    border-color: #2196F3;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.3);
    background: rgba(255,255,255,0.15);
}
.form-control option {
    background: #1e1e1e;
    color: white;
}
.btn {
    font-weight: 500;
    transition: all 0.3s ease;
}
.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
}
.form-group {
    background: rgba(255, 255, 255, 0.05);
    padding: 20px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}
.form-group:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(33, 150, 243, 0.3);
}
#status-display {
    transition: all 0.3s ease;
}
label {
    font-size: 16px;
    display: flex;
    align-items: center;
}
label::before {
    content: "âš¡";
    margin-right: 8px;
    font-size: 18px;
}
</style>
{% endblock %}
